" è®¾ç½® {{{
" æ˜¾å¼è®¾ç½®å½“å‰è„šæœ¬çš„ç¼–ç æ–¹å¼ä»¥æ”¯æŒå¤šå­—èŠ‚å­—ç¬¦
scriptencoding utf-8
let g:python_host_prog  = '/usr/local/bin/python'
let g:python3_host_prog = '/usr/local/bin/python3'

" filetype on
" filetype plugin on

" å§‹ç»ˆä½¿ç”¨ç³»ç»Ÿå‰ªåˆ‡æ¿
set clipboard+=unnamedplus

set foldlevel=10
set relativenumber

" å¼€å¯ NVIM ä¸“ç”¨é€‰é¡¹
if has('nvim')
  " å…è®¸çœŸå½©æ˜¾ç¤º
  let $NVIM_TUI_ENABLE_TRUE_COLOR = 1
  " å…è®¸å…‰æ ‡å˜åŒ–
  let $NVIM_TUI_ENABLE_CURSOR_SHAPE = 1
endif

" è®¾ç½®æŸ¥æ‰¾æ–‡ä»¶æ—¶ä½¿ç”¨çš„è·¯å¾„
set path=.,$HOME/.local/include,/usr/local/include,/usr/include,,

" è®© ./ åœ¨ 'tags' é€‰é¡¹é‡Œè¡¨ç¤ºç›¸å¯¹äºå½“å‰è·¯å¾„è€Œä¸æ˜¯ç›¸å¯¹äºå½“å‰æ–‡ä»¶
set cpoptions+=d
" set cpoptions+=n

" æ’å…¥æ¨¡å¼è‡ªåŠ¨è¡¥å…¨æ ‡ç­¾æ˜¾ç¤ºæ›´å¤šä¿¡æ¯
set showfulltag

" ç¦æ­¢è¿‡é•¿çš„è¡Œå›ç»•ï¼ˆè¶…è¿‡å±å¹•å®½åº¦ï¼‰
" set nowrap

" è®©æ°´å¹³æ»šåŠ¨æ›´åŠ è‡ªç„¶
set sidescroll=1
set sidescrolloff=3

" è®¾ç½®ç©ºç™½å­—ç¬¦çš„è§†è§‰æç¤ºï¼ˆeol:Â¬,nbsp:Ë½,ï¼‰
set list listchars=extends:â¯,precedes:â®,tab:â–¸\ ,trail:Ë½

" æ¶ˆé™¤ç¢çœ¼çš„æ–‡å­—
set shortmess+=I

" è®¾ç½®è¡Œå®½çš„è§†è§‰æç¤º
set colorcolumn=80

" è‡ªå®šä¹‰æ‹¼å†™æ£€æŸ¥
set nospell spelllang=en_us
set spellsuggest=best,5

" åœ¨å³è¾¹æ‰“å¼€æ–°çš„çª—å£ï¼ˆå‚ç›´åˆ†å‰²ï¼‰
set splitright

" æ¨¡å¼åˆ‡æ¢ï¼ˆåœ¨çŠ¶æ€æ å·¦ä¸‹æ–¹ï¼‰
set noshowmode

" æŒ‰é”®æç¤ºï¼ˆåœ¨çŠ¶æ€æ å³ä¸‹æ–¹ï¼‰
set showcmd

" æ˜¾ç¤ºè¡Œå·ï¼åˆ—å·ç­‰é™„åŠ ä¿¡æ¯ï¼ˆåœ¨çŠ¶æ€æ å³æ–¹ï¼‰
set ruler

" è®¾ç½®è¡Œçš„æœ€å¤§å®½åº¦ï¼ˆå¦‚æœå…è®¸æ–­è¡Œçš„è¯ï¼‰
set textwidth=80

" è®¾ç½®æ ¼å¼åŒ–é€‰é¡¹
set formatoptions=cjmqrtB

" è®¾ç½®è‡ªåŠ¨è¡¥å…¨é€‰é¡¹
set omnifunc=syntaxcomplete#Complete
set complete=.,w,b,u,U,d,t
set completeopt=longest,menuone,preview
set completefunc=syntaxcomplete#Complete

" è‡ªåŠ¨è¡¥å…¨å€™é€‰çª—å£æœ€å¤§é«˜åº¦
set pumheight=10

" è‡ªåŠ¨æ›´æ­£è‡ªåŠ¨è¡¥å…¨é€‰é¡¹çš„å¤§å°å†™
set infercase

" è®¾ç½®å‘½ä»¤è¡Œè¡¥å…¨é€‰é¡¹
set wildmenu
set wildmode=list:longest,full

" è®¾ç½®æ’å…¥æˆå¯¹ç¬¦å·æ—¶é—ªçƒæŒ‡ç¤º
set showmatch
set matchtime=1

" è®¾ç½®ç¼©è¿›ç›¸å…³é€‰é¡¹
set tabstop=2 shiftwidth=2 softtabstop=2 expandtab shiftround smartindent

" set tabstop=4 shiftwidth=4 softtabstop=4 expandtab shiftround smartindent

" å…è®¸ä¿å­˜ undo çŠ¶æ€
" set undofile

" å…è®¸åœ¨æœªä¿å­˜æ—¶åˆ‡æ¢ buffers
set hidden
" }}}

" çŠ¶æ€æ  {{{
" è‡ªå®šä¹‰çŠ¶æ€æ é…ç½®
" if has('statusline')
"   set laststatus=2

"   set statusline=%<                                       " çŠ¶æ€æ å¼€å§‹
"   set statusline+=%.40f                                   " ç›¸å¯¹è·¯å¾„çš„å½“å‰æ–‡ä»¶
"   set statusline+=%y                                      " æ–‡ä»¶ç±»å‹
"   set statusline+=[%{&ff}]                                " æ–‡ä»¶æ ¼å¼
"   set statusline+=[%{strlen(&fenc)?&fenc:'none'}]         " æ–‡ä»¶ç¼–ç 
"   set statusline+=%m                                      " æ›´æ”¹çŠ¶æ€
"   set statusline+=%h                                      " å¸®åŠ©æ ‡è¯†
"   set statusline+=%r                                      " åªè¯»æ ‡è¯†
"   if exists(':Pencil')
"     set statusline+=%<\ %{PencilMode()}                   " æ’ä»¶
"   endif

"   set statusline+=%*                                      " æ¢å¤é«˜äº®
"   set statusline+=%=                                      " çŠ¶æ€æ å³è¾¹
"   set statusline+=%{exists('g:loaded_fugitive')?fugitive#statusline():''}
"   set statusline+=%4l\ %02c\                              " è¡Œå·ï¼åˆ—å·
"   set statusline+=%3p%%\ in\ %-4L                         " å†…å®¹é•¿åº¦
" endif
" }}}

" æ˜ å°„ {{{
" æ˜ å°„ leader å’Œ localleader
nnoremap <SPACE> <nop>
let mapleader = "\\"
let maplocalleader = "\\"

" å®Œå–„æœ‰ç¼ºé™·çš„é»˜è®¤æ˜ å°„
nnoremap Y y$
nnoremap 0 g0
vnoremap 0 g0
nnoremap ^ g^
vnoremap ^ g^
nnoremap $ g$
vnoremap $ g$
nnoremap j gj
vnoremap j gj
nnoremap k gk
vnoremap k gk
nnoremap * *N
vnoremap * y:let @/=@"<CR>
nnoremap # #N
vnoremap # #N

" æ˜ å°„ä¸€äº›ä¸ªäººåå¥½ï¼ˆå¯é€‰ï¼‰
inoremap <C-f> <C-o>a
inoremap <C-b> <Esc>i

" æ˜ å°„ Enter -> :nohlsearchï¼ˆä»…å¸¸è§„æ¨¡å¼ï¼‰
nnoremap <silent> <CR> :nohlsearch<CR>

" æ˜ å°„ Options(Alt) + h/j/k/l åœ¨çª—å£ä¹‹é—´è·³è½¬
nnoremap <C-h> <C-w>h
nnoremap <C-j> <C-w>j
nnoremap <C-k> <C-w>k
nnoremap <C-l> <C-w>l
tnoremap <C-h> <C-\><C-n><C-w>h
tnoremap <C-j> <C-\><C-n><C-w>j
tnoremap <C-k> <C-\><C-n><C-w>k
tnoremap <C-l> <C-\><C-n><C-w>l

" æ˜ å°„ Control(Ctrl) + j/k x3 å€é€Ÿä¸Šä¸‹ç§»åŠ¨
" nnoremap <A-j> 3j
" nnoremap <A-k> 3k
" vnoremap <A-j> 3j
" vnoremap <A-k> 3k

" æ˜ å°„ Option(Alt) + h/l åœ¨æ ‡ç­¾é¡µä¹‹é—´è·³è½¬
nnoremap <A-[> gT
nnoremap <A-]> gt
tnoremap <C-\><C-n><A-h> gT
tnoremap <C-\><C-n><A-l> gt

" æ˜ å°„æ›´é«˜æ•ˆçš„èœå•é€‰æ‹©
inoremap <expr> <CR>  pumvisible() ? "\<C-y>" : "\<CR>"
inoremap <expr> <C-j> pumvisible() ? "\<C-n>" : "\<C-j>"
inoremap <expr> <C-k> pumvisible() ? "\<C-p>" : "\<C-k>"

" å¼€å¯å†…ç½® Terminal æ¨¡å¼
nnoremap <silent> <Leader>: :below 10sp term://$SHELL<CR>A

" NERDTree æ˜ å°„
" nnoremap <silent><Leader><F1> :NERDTreeFind<CR>
" nnoremap <silent><F1>         :NERDTreeToggle<CR>

" EasyAlign æ˜ å°„
nmap ga <Plug>(EasyAlign)
xmap ga <Plug>(EasyAlign)
" }}}

" ç¼©å†™ {{{
" ç¼©å†™ :so -> :source % ç”¨äºé‡æ–°åŠ è½½å½“å‰æ–‡ä»¶
cnoreabbrev <expr> so getcmdtype() == ':' && getcmdline() == 'so' ? 'source %' : 'so'
" ç¼©å†™ :sw -> :w !sudo tee % ç”¨äºè·å– Admin æƒé™å†™å…¥æ–‡ä»¶
cnoreabbrev <expr> sw getcmdtype() == ':' && getcmdline() == 'sw' ? 'w !sudo tee %' : 'sw'
" ç¼©å†™ :ev -> :tabedit PATH/TO/init.vim ç”¨äºæ–°å¼€æ ‡ç­¾é¡µç¼–è¾‘ init.vim æ–‡ä»¶
cnoreabbrev <expr> ev getcmdtype() == ':' && getcmdline() == 'ev' ? 'tabedit $MYVIMRC' : 'ev'
" ç¼©å†™ :ue -> :UltiSnipsEdit ç”¨äºç¼–è¾‘ UltiSnips
cnoreabbrev <expr> ue getcmdtype() == ':' && getcmdline() == 'ue' ? 'UltiSnipsEdit' : 'ue'
" }}}

" æ’ä»¶ {{{
if empty(glob('$HOME/.config/nvim/autoload/plug.vim'))
  silent !curl -fLo $HOME/.config/nvim/autoload/plug.vim --create-dirs
        \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  autocmd! VimEnter * PlugInstall | source $MYVIMRC
endif

call plug#begin('$HOME/.config/nvim/plugins')

Plug 'justinmk/vim-dirvish'

" Plug 'sheerun/vim-polyglot'
Plug 'zhou13/vim-easyescape'
let g:easyescape_chars = { "h": 2 }
let g:easyescape_timeout = 100
inoremap hh <ESC>
cnoremap hh <ESC>
tnoremap hh <ESC>

" easy navigate with s + 2chars
Plug 'justinmk/vim-sneak'
let g:sneak#label = 1

" Plug 'sonph/onehalf', {'rtp': 'vim/'}

Plug 'ayu-theme/ayu-vim' " or other package manager
" set termguicolors     " enable true colors support
" let ayucolor="light"  " for light version of theme
" Plug 'junegunn/fzf', { 'dir': '~/.fzf', 'do': './install --all' }
" FuzzyFinder should ignore all files in .gitignore
" let ignorefile = ".gitignore"
" if filereadable(ignorefile)
"   let ignore = '\v\~$'
"   for line in readfile(ignorefile)
"     if match(line, '^\s*$') == -1 && match(line, '^#') == -1
"       let line = substitute(line, '^/', '', '')
"       let line = substitute(line, '\.', '\\.', 'g')
"       let line = substitute(line, '\*', '.*', 'g')
"       let ignore .= '|^' . line
"     endif
"   endfor
"   let g:fuf_coveragefile_exclude = ignore
"   let g:fuf_file_exclude = ignore
"   let g:fuf_dir_exclude = ignore
" endif
" let g:fuf_dir_exclude = "\v\~$|"
" Plug 'junegunn/fzf.vim'


" nnoremap <silent> <C-f> :GFiles --exclude-standard --others --cached<CR>
" nnoremap <silent> <C-g> :Buffers<CR>
"...
if (has("termguicolors"))
  set termguicolors
endif
"let ayucolor="light"  " for light version of theme
"let ayucolor="mirage" " for mirage version of theme
"let ayucolor="dark"   " for dark version of theme
"colorscheme ayu

" NOTE: å°½é‡ä¸è¦ä¾èµ–è¿™ç§ä»¥è§†è§‰æŸ¥æ‰¾ä¸ºä¸»çš„æ’ä»¶ï¼Œæ•ˆç‡æ€æ‰‹ï¼
"       æˆ‘ä¸€èˆ¬åœ¨å‘åˆ«äººè®²è§£é¡¹ç›®ç»“æ„æˆ–è€…å¯è§†åŒ–çš„æ¼”ç¤ºä½¿ç”¨
Plug 'scrooloose/nerdtree'                           " æ ‘å½¢æ–‡ä»¶æŸ¥çœ‹æ’ä»¶
" let NERDTreeIgnore              = ['.sass-cache$', 'tmp$']
" let NERDTreeSortOrder           = ['\/$', '*']
" let NERDTreeWinPos              = 'left'
" let NERDTreeWinSize             = 40
" let NERDTreeChDirMode           = 1
" let NERDTreeDirArrows           = 1
" let NERDTreeMinimalUI           = 1
" let NERDTreeMouseMode           = 2
" let NERDTreeShowHidden          = 0
" let NERDTreeQuitOnOpen          = 0
" let NERDTreeHijackNetrw         = 1
" let NERDTreeSortHiddenFirst     = 1
" let NERDTreeAutoDeleteBuffer    = 1
" let NERDTreeCaseSensitiveSort   = 1
" let NERDTreeHighlightCursorline = 1

" Plug 'rking/ag.vim'                                  " the_silver_searcher

Plug 'mileszs/ack.vim'

"the search engine is ag now
"let g:ackprg = 'ag --nogroup --nocolor --column'
" let g:ag_working_path_mode="r"
"
set autochdir

Plug 'itchyny/lightline.vim'                         " è½»é‡çº§çŠ¶æ€æ ä¼˜åŒ–æ’ä»¶
function! CocCurrentFunction()
    return get(b:, 'coc_current_function', '')
endfunction

nnoremap <silent> <C-b> :<C-u>CocList files<CR>
nnoremap <silent> <C-f> :<C-u>CocList files -F<CR>
nnoremap <silent> <C-g> :<C-u>CocList buffers<CR>
nnoremap <silent> <C-p> :<C-u>Clap grep<CR>

set updatetime=300

" Remap keys for gotos
nmap <silent> gd <Plug>(coc-definition)
nmap <silent> gy <Plug>(coc-type-definition)
nmap <silent> gi <Plug>(coc-implementation)
nmap <silent> gr <Plug>(coc-references)

nnoremap <silent> K :call <SID>show_documentation()<CR>

function! s:show_documentation()
  if (index(['vim','help'], &filetype) >= 0)
    execute 'h '.expand('<cword>')
  else
    call CocAction('doHover')
  endif
endfunction

function! StatusDiagnostic() abort
  let info = get(b:, 'coc_diagnostic_info', {})
  if empty(info) | return '' | endif
  let msgs = []
  if get(info, 'error', 0)
    call add(msgs, 'E' . info['error'])
  endif
  if get(info, 'warning', 0)
    call add(msgs, 'W' . info['warning'])
  endif
  return join(msgs, ' '). ' ' . get(g:, 'coc_status', '')
endfunction

function! LightlineFilename()
  let root = fnamemodify(get(b:, 'git_dir'), ':h')
  let path = expand('%:p')
  if path[:len(root)-1] ==# root
    return path[len(root)+1:]
  endif
  return expand('%')
endfunction

let g:lightline = {
      \ 'colorscheme': 'wombat',
      \ 'active': {
      \   'left': [ [ 'mode', 'paste' ],
      \             [ 'cocstatus','gitbranch', 'currentfunction', 'message', 'readonly', 'modified', 'filepath' ] ]
      \ },
      \ 'component_function': {
      \   'cocstatus': 'coc#status',
      \   'gitbranch': 'fugitive#head',
      \   'filepath': 'LightlineFilename',
      \   'abspath': '%F',
      \   'relativepath': '%f',
      \   'currentfunction': 'CocCurrentFunction',
      \   'message': 'StatusDiagnostic'
      \ },
      \ }
" let g:lightline = {
"       \   'colorscheme': 'powerline',
"       \   'active': {
"       \     'left': [ ['mode', 'paste'],
"       \               ['readonly', 'filename', 'modified', 'fugitive'] ]
"       \   },
"       \   'component': {
"       \     'fugitive': '%{exists("*fugitive#head")?fugitive#head():""}'
"       \   },
"       \   'component_visible_condition': {
"       \     'fugitive': '(exists("*fugitive#head") && ""!=fugitive#head())'
"       \   }
"       \ }

Plug 'tpope/vim-repeat'                              " æ‰©å±•é‡å¤å‘½ä»¤çš„åº”ç”¨èŒƒå›´
Plug 'tpope/vim-surround'                            " å¢å¼ºå„ç§æˆå¯¹å­—ç¬¦çš„æ“ä½œ
Plug 'tpope/vim-commentary'                          " æä¾›ç®€å•çš„å¿«æ·æ³¨é‡ŠåŠŸèƒ½
Plug 'tpope/vim-unimpaired'                          " è¡¥å……æˆå¯¹æ“ä½œçš„é”®ä½æ˜ å°„

Plug 'kana/vim-textobj-user'                         " å…è®¸ç”¨æˆ·å®šä¹‰æ–‡æœ¬å¯¹è±¡
Plug 'reedes/vim-pencil'                             " æ–‡æœ¬å†™ä½œè¾…åŠ©å·¥å…·
Plug 'reedes/vim-textobj-quote'                      " æ”¯æŒæ’ç‰ˆæ ¼å¼å¼•å·å­—ç¬¦
Plug 'reedes/vim-textobj-sentence'                   " æ”¯æŒæ›´è‡ªç„¶çš„å¥å­å¯¹è±¡
Plug 'junegunn/goyo.vim'                             " æä¾›å…å¹²æ‰°çš„å†™ä½œç¯å¢ƒ
Plug 'junegunn/limelight.vim'                        " é…åˆ Goyo æä¾›è¡Œèšç„¦

" TODO: READ DEOPLETE FOR RECOMMENDED EXTERNAL PLUGINS
" deoplete init for vim-plug
function! DoRemote(arg)
  UpdateRemotePlugins
endfunction
" å¼‚æ­¥è‡ªåŠ¨ä»£ç è¡¥å…¨
Plug 'autozimu/LanguageClient-neovim', {
    \ 'branch': 'next',
    \ 'do': 'bash install.sh',
    \ }

set hidden

set nobackup
set nowritebackup
set cmdheight=2

set signcolumn=yes
inoremap <silent><expr> <c-space> coc#refresh()
nmap <silent> [g <Plug>(coc-diagnostic-prev)
nmap <silent> ]g <Plug>(coc-diagnostic-next)
nmap <silent> gd <Plug>(coc-definition)
nmap <silent> gy <Plug>(coc-type-definition)
nmap <silent> gi <Plug>(coc-implementation)
nmap <silent> gr <Plug>(coc-references)

" let g:LanguageClient_serverCommands = {
"     \ 'rust': ['~/.cargo/bin/rustup', 'run', 'stable', 'rls'],
"     \ 'javascript': ['/usr/local/bin/javascript-typescript-stdio'],
"     \ 'javascript.jsx': ['tcp://127.0.0.1:2089'],
"     \ 'python': ['/usr/local/bin/pyls'],
"     \ 'ruby': ['~/.rbenv/shims/solargraph']
"     \ }



" Plug 'Shougo/deoplete.nvim', {'do': function('DoRemote')}
" let g:deoplete#enable_at_startup = 1                 " ç¼ºçœå¼€å¯è‡ªåŠ¨è¡¥å…¨

let g:loaded_ruby_provider = 1
" Let <Tab> also do completion
" inoremap <silent><expr> <Tab>
" \ pumvisible() ? "\<C-n>" :
" \ deoplete#mappings#manual_complete()

" let g:deoplete#omni#input_patterns.ruby =
"       \ ['[^. *\t]\.\w*', '[a-zA-Z_]\w*::']
" å‡ºç°å€™é€‰é¡¹ç›®çš„æ—¶å€™ä½¿ç”¨tab
" inoremap <expr> <Tab> pumvisible() ? "\<C-n>" : "\<Tab>"
" inoremap <expr> <S-Tab> pumvisible() ? "\<C-p>" : "\<S-Tab>"


" <CR> ç›´æ¥æ¢è¡Œè€Œä¸æ‰§è¡Œ deoplete çš„é»˜è®¤è¡Œä¸º
" inoremap <silent> <CR> <C-r>=<SID>return_without_deoplete()<CR>
" function! s:return_without_deoplete() abort
"   return deoplete#mappings#close_popup() . "\<CR>"
" endfunction
Plug 'Shougo/context_filetype.vim'                   " æä¾›æ’ä»¶åˆ‡æ¢æ–‡æ¡£ç±»å‹èƒ½åŠ›
Plug 'Konfekt/FastFold'                              " å‰Šå‡ä»£ç æŠ˜å å¯¹æ€§èƒ½çš„å½±å“

Plug 'SirVer/ultisnips' | Plug 'honza/vim-snippets'  " æ™ºèƒ½ä»£ç ç‰‡æ–­å·¥å…·
let g:UltiSnipsSnippetsDir         = $HOME.'/.config/nvim/UltiSnips'
let g:UltiSnipsExpandTrigger       = '<TAB>'
let g:UltiSnipsListSnippets        = '<A-TAB>'
let g:UltiSnipsJumpForwardTrigger  = '<TAB>'
let g:UltiSnipsJumpBackwardTrigger = '<S-TAB>'
let g:UltiSnipsMappingsToIgnore    = ["deoplete"]

Plug 'editorconfig/editorconfig-vim'                 " Editor Config é…ç½®æ’ä»¶
let g:EditorConfig_exec_path        = '/usr/local/bin/editorconfig'
let g:EditorConfig_exclude_patterns = ['fugitive://.*', 'scp://.*']

" Git æ•´åˆ
Plug 'tpope/vim-fugitive'
Plug 'junegunn/gv.vim'

Plug 'junegunn/vim-peekaboo'                         " é¢„è§ˆæ³¨å†Œå™¨çš„å†…å®¹

Plug 'junegunn/vim-easy-align'                       " å¼ºæ‚åˆç®€çº¦çš„æ™ºèƒ½å¯¹é½
" Start interactive EasyAlign in visual mode (e.g. vip<Enter>)
vmap <Enter> <Plug>(EasyAlign)

" Start interactive EasyAlign for a motion/text object (e.g. gaip)
nmap ga <Plug>(EasyAlign)

Plug 'benekastah/neomake'
let g:neomake_error_sign   = {'text': 'ğŸ˜¡ '}
let g:neomake_warning_sign = {'text': 'ğŸ˜  '}

" Markdown
Plug 'plasticboy/vim-markdown', {'for': 'markdown'}
let g:vim_markdown_toc_autofit      = 1
let g:vim_markdown_frontmatter      = 1
let g:vim_markdown_json_frontmatter = 1
let g:vim_markdown_toml_frontmatter = 1
let g:vim_markdown_folding_disabled = 1

" XML
" Plug 'othree/xml.vim', {'for': ['html', 'html.handlebars']}

" HTML
" Plug 'othree/html5.vim', {'for': ['html', 'html.handlebars']}

" Handlebars
" Plug 'mustache/vim-mustache-handlebars', {'for': ['html.handlebars']}
" let g:mustache_abbreviations = 1                     " å†…ç½®ç¼©å†™å±•å¼€

" CSS
Plug 'JulesWang/css.vim', {'for': ['css', 'less', 'scss']}
Plug 'hail2u/vim-css3-syntax', {'for': ['css', 'less', 'scss']}
Plug 'othree/csscomplete.vim', {'for': ['css', 'less', 'scss']}
Plug 'genoma/vim-less', {'for': ['css', 'less']}
Plug 'cakebaker/scss-syntax.vim', {'for': ['css', 'scss']}
Plug 'stephenway/postcss.vim', {'for': 'css'}

" JavaScript
Plug 'pangloss/vim-javascript', {'for': ['javascript', 'javascript.jsx']}
let g:javascript_enable_domhtmlcss    = 1
let g:javascript_ignore_javaScriptdoc = 1
" let g:javascript_conceal_function     = "ğ›Œ"
" let g:javascript_conceal_null         = "ğ›ˆ"
" let g:javascript_conceal_this         = "ğ›"
" let g:javascript_conceal_return       = "ğ›‡"
" let g:javascript_conceal_undefined  = "ğ›˜"
" let g:javascript_conceal_NaN          = "ğ›†"
" let g:javascript_conceal_prototype    = "ğ›•"
" let g:javascript_conceal_static       = "ğ›“"
" let g:javascript_conceal_super        = "ğ›"
" let g:javascript_conceal_arrow_function = "â‡’"
Plug 'jason0x43/vim-js-indent', {'for': ['javascript', 'javascript.jsx', 'typescript']}
Plug 'othree/jsdoc-syntax.vim', {'for': ['javascript', 'javascript.jsx']}
Plug '1995eaton/vim-better-javascript-completion', {'for': ['javascript', 'javascript.jsx']}
let g:vimjs#chromeapis    = 1
let g:vimjs#smartcomplete = 1

Plug 'mattn/emmet-vim'

" JSX
Plug 'mxw/vim-jsx', {'for': 'javascript.jsx'}

" JSON
Plug 'elzr/vim-json', {'for': 'json'}

" Rails
Plug 'tpope/vim-rails', {'for': ['ruby', 'erb']}

" TypeScript
Plug 'Quramy/tsuquyomi', {'for': 'typescript'}
Plug 'leafgarland/typescript-vim', {'for': 'typescript'}

" TOML
Plug 'cespare/vim-toml', {'for': 'toml'}

" Elixir
" Plug 'slashmili/alchemist.vim', {'for': ['elixir', 'eelixir']}
Plug 'elixir-editors/vim-elixir'
" Plug 'mhinz/vim-mix-format'
" let g:mix_format_on_save = 1
Plug 'powerman/vim-plugin-AnsiEsc'                   " å¤„ç† ansi escape sequences

" Coffee
Plug 'kchmck/vim-coffee-script', {'for': ['coffee']}


" Docker
Plug 'ekalinin/Dockerfile.vim', {'for': 'docker'}

" SQL
Plug 'shmup/vim-sql-syntax', {'for': 'sql'}

" color

Plug 'flazz/vim-colorschemes'
Plug 'gcmt/wildfire.vim'
" Plug 'ap/vim-css-color'
" Plug 'ervandew/supertab'
"
Plug 'c-brenn/phoenix.vim'
Plug 'tpope/vim-projectionist'
Plug 'christoomey/vim-tmux-navigator'

" use gr{motion}, grr, {Visul}gr
" Plug 'ReplaceWithRegister'
" Plug 'rhysd/clever-f.vim'

" Plug 'nathanaelkane/vim-indent-guides'
" let g:indent_guides_enable_on_vim_startup = 1



" Plug 'w0rp/ale'
Plug 'liuchengxu/vim-clap'


Plug 'posva/vim-vue'

Plug 'neoclide/coc.nvim', {'branch': 'release'}

" Run both javascript and vue linters for vue files.
" let g:ale_linter_aliases = ['javascript', 'vue']
" Select the eslint and vls linters.
" let g:ale_linter_aliases = {'vue': ['vue', 'javascript']}
" let g:ale_linters = {'vue': ['eslint', 'vls'], 'typescript' : ['tsserver', 'tslint']}

"let g:ale_fixers = {
"\   '*': ['remove_trailing_lines', 'trim_whitespace'],
"\   'javascript': ['eslint'],
"\   'typescript': ['prettier', 'tslint'],
"\   'vue': ['eslint'],
"\   'ruby': ['rubocop']
"\}
"let g:ale_fix_on_save = 1

Plug 'airblade/vim-gitgutter'
" Plug 'yuttie/comfortable-motion.vim'
" let g:comfortable_motion_scroll_down_key = "j"
" let g:comfortable_motion_scroll_up_key = "k"

" Plug 'tpope/vim-endwise'

" let g:ale_sign_column_always = 1

" Plug 'Syntastic
" Plug 'vim-syntastic/syntastic'

" let g:syntastic_ruby_checkers = ['rubocop']

" let g:syntastic_mode_map = { 'passive_filetypes': ['sass', 'scss'] }

" let g:syntastic_enable_elixir_checker = 1
" let g:syntastic_elixir_checkers = ["elixir"]

" let g:indent_guides_enable_on_vim_startup = 1



" let g:indent_guides_auto_colors = 0
" hi IndentGuidesOdd  guibg=red   ctermbg=3
" hi IndentGuidesEven guibg=green ctermbg=4

" let g:indent_guides_auto_colors = 0
" autocmd VimEnter,Colorscheme * :hi IndentGuidesOdd  ctermbg=236
" autocmd VimEnter,Colorscheme * :hi IndentGuidesEven ctermbg=237

" record using time for vim
Plug 'wakatime/vim-wakatime'
Plug 'colepeters/spacemacs-theme.vim'



call plug#end()
" }}}

" ä¸»é¢˜ {{{
" set background=dark
" colorscheme gruvbox
" colorscheme Tomorrow-Night
" colorscheme spacemacs-theme

" TODO: è®¾ç½®å†…ç½®ç»ˆç«¯çš„é¢œè‰²
" let g:terminal_color_0  = '#282a36'
" let g:terminal_color_1  = '#ff5555'
" let g:terminal_color_2  = '#50fa7b'
" let g:terminal_color_3  = '#f1fa8c'
" let g:terminal_color_4  = '#bd93f9'
" let g:terminal_color_5  = '#ff79c6'
" let g:terminal_color_6  = '#8be9fd'
" let g:terminal_color_7  = '#50fa7b'
" let g:terminal_color_8  = '#555753'
" let g:terminal_color_9  = '#ef2929'
" let g:terminal_color_10 = '#8ae234'
" let g:terminal_color_11 = '#fce94f'
" let g:terminal_color_12 = '#729fcf'
" let g:terminal_color_13 = '#ad7fa8'
" let g:terminal_color_14 = '#00f5e9'
" let g:terminal_color_15 = '#eeeeec'
" }}}

" è‡ªåŠ¨å‘½ä»¤ {{{
augroup NVIM_SETTINGS
  autocmd!
  autocmd FileType conf,vim setlocal foldmethod=marker
  autocmd BufWritePost $MYVIMRC nested source $MYVIMRC
augroup END

augroup MARKUP_LANGUAGE
  autocmd!
  autocmd User GoyoEnter Limelight
  autocmd User GoyoLeave Limelight!
  autocmd FileType markdown setlocal conceallevel=2 formatoptions+=aM
        \                 | call pencil#init({'wrap': 'soft', 'textwidth': 72})
        \                 | call textobj#quote#init()
        \                 | call textobj#sentence#init()
        \                 | setlocal nolinebreak
  autocmd FileType html,html.handlebars setlocal textwidth=0
augroup END

augroup STYLESHEET
  autocmd!
  " autocmd BufNewFile,BufRead *.css setlocal filetype=scss
  autocmd FileType css,less,scss setlocal colorcolumn=80 iskeyword+=-
augroup END

augroup JAVASCRIPT
  autocmd!
  " autocmd BufWritePost *.js,*.jsx update | Neomake eslint
  autocmd FileType javascript,javascript.jsx setlocal colorcolumn=80 conceallevel=2 iskeyword+=$
  " autocmd FileType html,html.handlebars,javascript,javascript.jsx,json,yaml colorscheme material-theme
augroup END

" augroup ELIXIR
"   autocmd!
"   autocmd FileType elixir setlocal colorcolumn=80 " foldmethod=syntax foldlevel=1 foldnestmax=2
" augroup END

augroup OMNIFUNCS
  autocmd!
  autocmd FileType css             setlocal omnifunc=csscomplete#CompleteCSS
  autocmd FileType scss            setlocal omnifunc=csscomplete#CompleteCSS
  autocmd FileType html            setlocal omnifunc=htmlcomplete#CompleteTags
  autocmd FileType html.handlebars setlocal omnifunc=htmlcomplete#CompleteTags
  autocmd FileType javascript      setlocal omnifunc=js#CompleteJS
  autocmd FileType javascript.jsx  setlocal omnifunc=js#CompleteJS
  autocmd FileType ruby            setlocal omnifunc=rubycomplete#Complete
  autocmd FileType xml             setlocal omnifunc=xmlcomplete#CompleteTags
augroup END

augroup CUSTOM_HIGHLIGHT
  autocmd!
  autocmd WinEnter,VimEnter * :silent! call matchadd('Todo', 'TODO:\s\|NOTE:\s\|FIXME:\s\|ISSUE:\s\|REVIEW:\s', -1)
augroup END

augroup MISC
  autocmd!
  " æ€»æ˜¯åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€å¸®åŠ©æ–‡æ¡£ï¼Œè§ï¼šHelpInNewTab()
  autocmd FileType help call HelpInNewTab()

  " æ’å…¥æ¨¡å¼ä¸‹åˆ‡æ¢åªå½“å‰æ–‡ä»¶è·¯å¾„ä»¥ä¾¿è‡ªåŠ¨è·¯å¾„è¡¥å…¨
  autocmd InsertEnter * let saved_cwd = getcwd() | set autochdir
  autocmd InsertLeave * set noautochdir | execute 'cd' fnameescape(saved_cwd)

  " ä¿å­˜æ—¶è‡ªåŠ¨åˆ›å»ºä¸å­˜åœ¨çš„ç›®å½•
  autocmd BufWritePre,FileWritePre * call <SID>mkdir_on_save()
augroup END
" }}}

" è¾…åŠ©å‡½æ•° {{{
" ä½¿ç”¨æ–°çš„ Tab æ‰“å¼€å¸®åŠ©æ–‡æ¡£
function! HelpInNewTab()
  if &buftype == 'help' | execute "silent normal \<C-w>T" | endif
endfunction

" ä¿å­˜æ—¶åˆ›å»ºä¸å­˜åœ¨çš„ç›®å½•
function! <SID>mkdir_on_save()
  let s:directory = expand('<afile>:p:h')
  if !isdirectory(s:directory)
    call mkdir(s:directory, 'p')
  endif
endfunction
" }}}
"

vnoremap <C-x>c "+y
nnoremap <C-x>c "+p
nnoremap <Leader>/ :vsplit
nnoremap <Leader>n :lnext<CR>
nnoremap <Leader>p :lprevious<CR>
nnoremap <Leader>w :w<CR>

nnoremap <C-h> <C-w><Left>
nnoremap <C-l> <C-w><Right>
nnoremap <C-k> <C-w><Up>
nnoremap <C-j> <C-w><Down>
nnoremap <Leader>i :tabfirst<CR>
nnoremap <Leader>c :tabonly<CR>

noremap <leader>1 1gt
noremap <leader>2 2gt
noremap <leader>3 3gt
noremap <leader>4 4gt
noremap <leader>5 5gt
noremap <leader>6 6gt
noremap <leader>7 7gt
noremap <leader>8 8gt
noremap <leader>9 9gt
noremap <leader>0 :tablast<cr>

nnoremap <leader>ff :let @*=expand("%")<CR>

noremap <Leader>e :NERDTreeFind<CR>
if has('nvim')
   nnoremap <silent> <BS> :TmuxNavigateLeft<cr>
endif

autocmd BufReadPost *
     \ if line("'\"") > 0 && line("'\"") <= line("$") |
     \   exe "normal! g`\"" |
     \ endif

" let ale_emit_conflict_warnings = 0

" inoremap (; (<CR>);<C-c>O
" inoremap (, (<CR>),<C-c>O
" inoremap {; {<CR>};<C-c>O
" inoremap {, {<CR>},<C-c>O
" inoremap [; [<CR>];<C-c>O
" inoremap [, [<CR>],<C-c>O

" Plug 'tpope/vim-endwise'
"
Plug 'tpope/vim-eunuch'

set synmaxcol=512
" Plug 'arzg/vim-corvine'

" quick navigate horizontal
" Plug 'unblevable/quick-scope'
" let g:qs_highlight_on_keys = ['f', 'F', 't', 'T']
" highlight QuickScopePrimary guifg='#afff5f' gui=underline ctermfg=155 cterm=underline
" highlight QuickScopeSecondary guifg='#5fffff' gui=underline ctermfg=81 cterm=underline

" Plug 'vim-scripts/ReplaceWithRegister'


" dont do lowercase in visual u
:vmap u <Nop>

Plug 'vim-scripts/ReplaceWithRegister'

Plug 'ryanoasis/vim-devicons'
set guifont=Inconsolata_Nerd_Font:h12

" let ayucolor="mirage" " for mirage version of theme
" let ayucolor="dark"   " for dark version of theme
colorscheme gruvbox

